<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>المنتجات — العـودة</title>
  <meta name="description" content="تصفح منتجات الأثاث المكتبي والمنزلي مع فلاتر حسب التصنيف والأسلوب." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="stylesheet" href="/assets/css/rtl.css" />
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="brand"><span data-i18n="brand">العـودة</span> <small>Alaouda</small></div>
      <nav class="nav" aria-label="التنقل الرئيسي">
        <a href="/" data-i18n="nav_home">الرئيسية</a>
        <a href="/about.html" data-i18n="nav_about">من نحن</a>
        <a href="/products.html" data-i18n="nav_products">المنتجات</a>
        <a href="/store.html" data-i18n="nav_store">المتجر</a>
        <a href="/contact.html" data-i18n="nav_contact">اتصل بنا</a>
      </nav>
      <button class="mobile-nav-toggle" aria-controls="mobile-menu" aria-expanded="false">☰</button>
      <div class="lang-switch" role="group" aria-label="تغيير اللغة">
        <button data-lang="ar">العربية</button>
        <button data-lang="en">English</button>
      </div>
    </div>
  </header>

  <div class="mobile-menu" id="mobile-menu" aria-hidden="true">
    <div class="mobile-drawer">
      <a href="/" data-i18n="nav_home">الرئيسية</a>
      <a href="/about.html" data-i18n="nav_about">من نحن</a>
      <a href="/products.html" data-i18n="nav_products">المنتجات</a>
      <a href="/store.html" data-i18n="nav_store">المتجر</a>
      <a href="/contact.html" data-i18n="nav_contact">اتصل بنا</a>
    </div>
  </div>

  <main class="container">
    <section class="section" data-animate>
      <h1 class="section-title" data-i18n="nav_products">المنتجات</h1>
      <form id="filters" class="grid" style="grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); align-items: end;">
        <label>
          <span data-i18n="filter_category">التصنيف</span>
          <select name="category">
            <option value="">—</option>
            <option value="office">مكتبي</option>
            <option value="home">منزلي</option>
          </select>
        </label>
        <label>
          <span data-i18n="filter_style">الأسلوب</span>
          <select name="style">
            <option value="">—</option>
            <option value="modern">حديث</option>
            <option value="classic">كلاسيكي</option>
          </select>
        </label>
      </form>
      <div class="grid cards" id="products"></div>
    </section>
  </main>

  <button class="whatsapp-fab" aria-label="تواصل عبر واتساب">واتساب</button>

  <div id="react-footer"></div>

  <!-- React + ReactDOM + Babel (for JSX in browser) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Footer component (JSX transpiled by Babel) -->
  <script type="text/babel" data-presets="react" src="/assets/js/footer-react.jsx"></script>

  <script type="module">
    import './assets/js/main.js';
    const listEl = document.getElementById('products');
    const form = document.getElementById('filters');

    function card(p) {
      const name = document.documentElement.lang === 'ar' ? p.name_ar : p.name_en;
      const desc = document.documentElement.lang === 'ar' ? p.desc_ar : p.desc_en;
      return `
        <article class="card">
          <img src="${p.images[0]}" alt="${name}" loading="lazy" />
          <div class="card-body">
            <h3>${name}</h3>
            <p>${desc}</p>
            <div style="margin-top:8px; display:flex; gap:8px; flex-wrap: wrap;">
              <a class="btn btn-secondary" href="/contact.html?product=${encodeURIComponent(p.id)}">اطلب عرض سعر</a>
              <button class="btn btn-primary" data-view="${p.id}">عرض التفاصيل</button>
            </div>
          </div>
        </article>`;
    }

    function applyFilters(data) {
      const params = new URLSearchParams(new FormData(form));
      const cat = params.get('category');
      const style = params.get('style');
      const filtered = data.filter(p => (!cat || p.category === cat) && (!style || p.style === style));
      history.replaceState(null, '', `?${params.toString()}`);
      listEl.innerHTML = filtered.map(card).join('');
    }

    const products = await fetch('/data/products.json').then(r=>r.json());
    // Initialize from URL
    const initParams = new URLSearchParams(location.search);
    form.category.value = initParams.get('category') || '';
    form.style.value = initParams.get('style') || '';

    applyFilters(products);
    form.addEventListener('change', () => applyFilters(products));

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>